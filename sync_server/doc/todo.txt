数据库表结构确定
model代码生成
api接口定义
api接口实现
rabbitmq，队列定义
rabbitmq消息消费，日志入库。


【需解决问题】
删除bea的时候，trigger里面，自动将bea_map也清除掉？
删除trigger // ok
person表，需要加一个映射表？ // 增加映射
直接创建uuid的person，会覆盖已经存在的数据吗？
是传回一个合并过的特征值，还是每张图的特征值？ // 返回每张图的特征值


同步数据顺序：fetch camera, fetch db, fetch person
增加 db_del和 fea_del表


修改db容量：
在x86上，先删除旧db,然后创建新db(uuid相同)，然后修改fea表对应数据的的时间戳(对应db)
fea_del表的时间戳不需要修改




access log中 referer显示问题。 v

box_agent 包含两个功能
1）采集+比对
2）同步底库+摄像头

在x86+sc5+大底库的情况下，比对放在x86上，倒查也放在


【场景】
摄像头：大量摄像头
存储：大量的抓拍记录和图片存储
倒查功能：需要倒查(track要存到算法db中，需要x86+sc5结构)，不需要倒查(track不需要存到算法db中）
底库：小底库(2-5w，每个小盒子都存一份全量，在小盒子上比对)，大底库（底库存到x86+sc5结构中，小盒子只采集，记录上传到x86+sc5中比对）


【模块】
小盒子上跑两个程序
1）采集处理程序：接收算法的抓拍（进行合并处理），进行底库比对/或不比对，上传抓拍到track仓库
2) 摄像头和底库同步，客户端程序：订阅rabbitmq消息，触发或定时去拉取摄像头和底库的更新记录，更新到算法中去

x86上（不需要sc5也可以）跑的程序
1）摄像头和底库同步，服务端程序：提供http接口，供客户端程序来拉取摄像头和底库更新记录。
2) 摄像头和底库同步，客户端程序：订阅rabbitmq消息，触发或定时去拉取摄像头和底库的更新记录，更新到算法中去 (大底库的情况，需sc5)
3) track仓库：
    a) 接收小盒子上传的记录，存储数据库记录（大数据库mysql/mongo），存储track文件（文件系统和对象存储系统 minio）
    b) track比对（如果是大底库)，需调用sc5所在机器来处理
    c) 将抓拍的track，放入到sc5所在机器的算法底库中，供倒查用. (如果要倒查的话）
    c) 将比对过的track放入到rabbitmq中去。
4）对外算法服务：
    a) 裁剪/特征提取/1:1/ （需要sc5或se5）
    b) 底库1:N查询 (需要sc5或se5)
    c) 倒查(需要sc5)

x86 + sc5
1) 安装算法的server程序，提供算法底库以及比对功能。



【】
多个库的同步问题





